See [qtl2shiny/inst/scripts
/network_igraph.Rmd](https://github.com/byandell/qtl2shiny/blob/master/inst/scripts/network_igraph.Rmd) for more ways to plot. Can also make interactive.

```{r message=FALSE}
nodes <- 
  readr::read_csv(system.file("data/foundrNode.csv", package = "foundrShiny"),
                  comment = "#") |>
  dplyr::filter(origin %in% c("server","panel","module"))
links <- 
  readr::read_csv(system.file("data/foundrEdge.csv", package = "foundrShiny"),
                  comment = "#") |>
  dplyr::filter(assign %in% c("module","arg"))
```

```{r eval=FALSE}
ulinks <- sort(unique(c(links$source, links$target)))
unodes <- sort(unique(nodes$node))
m <- match(ulinks, unodes)
ulinks[which(is.na(m))]
mm <- match(unodes, ulinks)
unodes[which(is.na(mm))]
```

```{r}
out <- links %>% filter(!(source %in% c("output","input")), !(target %in% c("output","input"))) %>%
  mutate(origin = source)
out <- bind_rows(
  out %>% select(-target),
  out %>% select(-source) %>% rename(source = "target")) %>%
  distinct(origin, source, assign) %>%
  arrange(assign, origin, source) %>%
  rename(node = "source", type = "assign")

readr::write_csv(out, "inst/extdata/out.csv")
```

```{r}
net <- igraph::graph_from_data_frame(d=links, vertices=nodes, directed=TRUE)
```

```{r}
net <- igraph::simplify(net, remove.multiple = F, remove.loops = TRUE) 
```

```{r}
#change arrow size and edge color:
igraph::E(net)$arrow.size <- .2
igraph::E(net)$edge.color <- "gray80"
```

```{r}
netModule <-
  igraph::delete_vertices(
    igraph::delete_edges(
      net,
      igraph::E(net)[assign == "arg"]),
    unclass(igraph::V(net)[origin == "server"]))
```

```{r}
plot(net)
```

```{r message=FALSE, warning=FALSE, fig.width=7, fig.height=7}
#jpeg("net.jpg", width = 700, height = 700)
plot(netModule, vertex.shape="none", 
     vertex.label=igraph::V(netModule)$name, 
     vertex.label.font=2, vertex.label.color="black",
     vertex.label.cex=0.5, edge.color="gray50",
     layout = igraph::layout_as_tree)
#invisible(dev.off())
```